// get_google_sports.js

// serpapi
const fetch = require('node-fetch');
const SERPAPI_APIKEY = process.env.SERPAPI_APIKEY;

const get_google_sports = async ({ query }) => {
  try {
    console.log(`get_google_sports function was called`);
    const serpApiUrl = `https://serpapi.com/search?q=${encodeURIComponent(query)}&api_key=${SERPAPI_APIKEY}`;
    const response = await fetch(serpApiUrl, {method: 'GET'});
    const data = await response.json();
    if(data.sports_results) { return data.sports_results; }
    else { return data.organic_results; }
  }
  catch (error) {
    console.log("Error: ", error.message);
    return { error: error.message };
  }
}

module.exports = { get_google_sports };

/*
{
  "name": "get_google_sports",
  "description": "This function connects to the Google Sports Search API to retrieve sports related search results from Google. Useful for looking up niche information about sports topics or trivia.",
  "parameters": {
    "type": "object",
    "properties": {
      "query": {
        "type": "string",
        "description": "The Google Sports search query, optimized to target the best results for the inquiry in question"
      }
    },
    "required": []
  }
}
*/